---
id: PR-05
track: providers
depends_on: [PR-04]
---
# PR-05: Implement `encode(RenderPlan)` export (Tier D only) for ALL providers

## Goal
Implement the new encode boundary in every provider, starting with Tier D (text) only, so integration can be wired safely without needing full parity immediately.

## Changes
For every provider component:
- Add exported function:
  - `encode(plan: RenderPlan) -> EncodeResult`
- Implement only Tier D handling initially:
  - Return `ProviderPayload` where body is platform-appropriate text payload (or JSON wrapper)
  - If plan tier is A/B/C, downgrade internally to D **only as a temporary fallback**, and emit a warning like `encoder_forced_downgrade`
- Add tests per provider:
  - given Tier D plan â†’ returns payload with expected content_type
  - ensures no panic, stable output shape

## Acceptance criteria
- All provider components export `encode` successfully
- All tests pass
- CI stays green

## Notes
- This makes the whole system integratable quickly with very low risk.
